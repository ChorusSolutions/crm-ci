<Activity x:Class="XrmWorkflowd357081244974850892ebd328e4c2f7b" xmlns="http://schemas.microsoft.com/netfx/2009/xaml/activities" xmlns:mva="clr-namespace:Microsoft.VisualBasic.Activities;assembly=System.Activities, Version=4.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" xmlns:mxs="clr-namespace:Microsoft.Xrm.Sdk;assembly=Microsoft.Xrm.Sdk, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" xmlns:mxsq="clr-namespace:Microsoft.Xrm.Sdk.Query;assembly=Microsoft.Xrm.Sdk, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" xmlns:mxswa="clr-namespace:Microsoft.Xrm.Sdk.Workflow.Activities;assembly=Microsoft.Xrm.Sdk.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" xmlns:s="clr-namespace:System;assembly=mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" xmlns:scg="clr-namespace:System.Collections.Generic;assembly=mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" xmlns:sco="clr-namespace:System.Collections.ObjectModel;assembly=mscorlib, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" xmlns:srs="clr-namespace:System.Runtime.Serialization;assembly=System.Runtime.Serialization, Version=4.0.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089" xmlns:this="clr-namespace:" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml">
  <x:Members>
    <x:Property Name="InputEntities" Type="InArgument(scg:IDictionary(x:String, mxs:Entity))" />
    <x:Property Name="CreatedEntities" Type="InArgument(scg:IDictionary(x:String, mxs:Entity))" />
  </x:Members>
  <this:XrmWorkflowd357081244974850892ebd328e4c2f7b.InputEntities>
    <InArgument x:TypeArguments="scg:IDictionary(x:String, mxs:Entity)" />
  </this:XrmWorkflowd357081244974850892ebd328e4c2f7b.InputEntities>
  <this:XrmWorkflowd357081244974850892ebd328e4c2f7b.CreatedEntities>
    <InArgument x:TypeArguments="scg:IDictionary(x:String, mxs:Entity)" />
  </this:XrmWorkflowd357081244974850892ebd328e4c2f7b.CreatedEntities>
  <mva:VisualBasic.Settings>Assembly references and imported namespaces for internal implementation</mva:VisualBasic.Settings>
  <mxswa:Workflow>
    <mxswa:Workflow.Variables>
      <Variable x:TypeArguments="mxs:EntityReference" Default="[New EntityReference()]" Name="CustomActivityStep1EmailTemplate_localParameter" />
      <Variable x:TypeArguments="x:Boolean" Default="False" Name="CustomActivityStep25InvalidRegularExpression_localParameter" />
      <Variable x:TypeArguments="x:Boolean" Default="False" Name="CustomActivityStep25MatchFound_localParameter" />
    </mxswa:Workflow.Variables>
    <mxswa:ActivityReference AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.Composite, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="CustomActivityStep1">
      <mxswa:ActivityReference.Properties>
        <sco:Collection x:TypeArguments="Variable" x:Key="Variables">
          <Variable x:TypeArguments="x:Object" Name="CustomActivityStep1_1" />
          <Variable x:TypeArguments="x:Object" Name="CustomActivityStep1_2" />
          <Variable x:TypeArguments="x:Object" Name="CustomActivityStep1_1_converted" />
        </sco:Collection>
        <sco:Collection x:TypeArguments="Activity" x:Key="Activities">
          <mxswa:GetEntityProperty Attribute="cdi_sentemailid" Entity="[InputEntities(&quot;primaryEntity&quot;)]" EntityName="cdi_sentemail" Value="[CustomActivityStep1_2]">
            <mxswa:GetEntityProperty.TargetType>
              <InArgument x:TypeArguments="s:Type">
                <mxswa:ReferenceLiteral x:TypeArguments="s:Type" Value="mxs:EntityReference" />
              </InArgument>
            </mxswa:GetEntityProperty.TargetType>
          </mxswa:GetEntityProperty>
          <mxswa:ActivityReference AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.EvaluateExpression, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="EvaluateExpression">
            <mxswa:ActivityReference.Arguments>
              <InArgument x:TypeArguments="x:String" x:Key="ExpressionOperator">SelectFirstNonNull</InArgument>
              <InArgument x:TypeArguments="s:Object[]" x:Key="Parameters">[New Object() { CustomActivityStep1_2 }]</InArgument>
              <InArgument x:TypeArguments="s:Type" x:Key="TargetType">
                <mxswa:ReferenceLiteral x:TypeArguments="s:Type" Value="mxs:EntityReference" />
              </InArgument>
              <OutArgument x:TypeArguments="x:Object" x:Key="Result">[CustomActivityStep1_1]</OutArgument>
            </mxswa:ActivityReference.Arguments>
          </mxswa:ActivityReference>
          <mxswa:ActivityReference AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.ConvertCrmXrmTypes, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="ConvertCrmXrmTypes">
            <mxswa:ActivityReference.Arguments>
              <InArgument x:TypeArguments="x:Object" x:Key="Value">[CustomActivityStep1_1]</InArgument>
              <InArgument x:TypeArguments="s:Type" x:Key="TargetType">
                <mxswa:ReferenceLiteral x:TypeArguments="s:Type" Value="mxs:EntityReference" />
              </InArgument>
              <OutArgument x:TypeArguments="x:Object" x:Key="Result">[CustomActivityStep1_1_converted]</OutArgument>
            </mxswa:ActivityReference.Arguments>
          </mxswa:ActivityReference>
          <mxswa:ActivityReference AssemblyQualifiedName="Dynamics.Consent.Click.Workflows.TemplateRetriever, Dynamics.Consent.Click.Workflows, Version=1.0.0.0, Culture=neutral, PublicKeyToken=c8eeb91fe05753dc" DisplayName="CustomActivityStep1">
            <mxswa:ActivityReference.Arguments>
              <InArgument x:TypeArguments="mxs:EntityReference" x:Key="SentEmail">[DirectCast(CustomActivityStep1_1_converted, Microsoft.Xrm.Sdk.EntityReference)]</InArgument>
              <OutArgument x:TypeArguments="mxs:EntityReference" x:Key="EmailTemplate">[CustomActivityStep1EmailTemplate_localParameter]</OutArgument>
            </mxswa:ActivityReference.Arguments>
          </mxswa:ActivityReference>
          <If Condition="[Microsoft.VisualBasic.IsNothing(CustomActivityStep1EmailTemplate_localParameter)]">
            <If.Then>
              <Assign x:TypeArguments="mxs:Entity" To="[CreatedEntities(&quot;CustomActivityStep1EmailTemplate_entity&quot;)]" Value="[New Entity()]" />
            </If.Then>
            <If.Else>
              <mxswa:RetrieveEntity Attributes="{x:Null}" Entity="[CreatedEntities(&quot;CustomActivityStep1EmailTemplate_entity&quot;)]" EntityId="[DirectCast(CustomActivityStep1EmailTemplate_localParameter.Id, System.Guid)]" EntityName="cdi_emailtemplate" ThrowIfNotExists="False" />
            </If.Else>
          </If>
        </sco:Collection>
      </mxswa:ActivityReference.Properties>
    </mxswa:ActivityReference>
    <mxswa:ActivityReference AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.ConditionSequence, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="ConditionStep2">
      <mxswa:ActivityReference.Arguments>
        <InArgument x:TypeArguments="x:Boolean" x:Key="Wait">False</InArgument>
      </mxswa:ActivityReference.Arguments>
      <mxswa:ActivityReference.Properties>
        <sco:Collection x:TypeArguments="Variable" x:Key="Variables">
          <Variable x:TypeArguments="x:Boolean" Default="False" Name="ConditionBranchStep3_condition" />
          <Variable x:TypeArguments="x:Object" Name="ConditionBranchStep3_1" />
        </sco:Collection>
        <sco:Collection x:TypeArguments="Activity" x:Key="Activities">
          <mxswa:GetEntityProperty Attribute="cdi_emailtemplateid" Entity="[CreatedEntities(&quot;CustomActivityStep1EmailTemplate_entity&quot;)]" EntityName="cdi_emailtemplate" Value="[ConditionBranchStep3_1]">
            <mxswa:GetEntityProperty.TargetType>
              <InArgument x:TypeArguments="s:Type">
                <mxswa:ReferenceLiteral x:TypeArguments="s:Type">
                  <x:Null />
                </mxswa:ReferenceLiteral>
              </InArgument>
            </mxswa:GetEntityProperty.TargetType>
          </mxswa:GetEntityProperty>
          <mxswa:ActivityReference AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.EvaluateCondition, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="EvaluateCondition">
            <mxswa:ActivityReference.Arguments>
              <InArgument x:TypeArguments="mxsq:ConditionOperator" x:Key="ConditionOperator">NotNull</InArgument>
              <x:Null x:Key="Parameters" />
              <InArgument x:TypeArguments="x:Object" x:Key="Operand">[ConditionBranchStep3_1]</InArgument>
              <OutArgument x:TypeArguments="x:Boolean" x:Key="Result">[ConditionBranchStep3_condition]</OutArgument>
            </mxswa:ActivityReference.Arguments>
          </mxswa:ActivityReference>
          <mxswa:ActivityReference AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.ConditionBranch, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="ConditionBranchStep3">
            <mxswa:ActivityReference.Arguments>
              <InArgument x:TypeArguments="x:Boolean" x:Key="Condition">[ConditionBranchStep3_condition]</InArgument>
            </mxswa:ActivityReference.Arguments>
            <mxswa:ActivityReference.Properties>
              <mxswa:ActivityReference x:Key="Then" AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.Composite, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="ConditionBranchStep3">
                <mxswa:ActivityReference.Properties>
                  <sco:Collection x:TypeArguments="Variable" x:Key="Variables" />
                  <sco:Collection x:TypeArguments="Activity" x:Key="Activities">
                    <mxswa:ActivityReference AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.Composite, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="CustomActivityStep25: Check Tag">
                      <mxswa:ActivityReference.Properties>
                        <sco:Collection x:TypeArguments="Variable" x:Key="Variables">
                          <Variable x:TypeArguments="x:Object" Name="CustomActivityStep25_1" />
                          <Variable x:TypeArguments="x:Object" Name="CustomActivityStep25_2" />
                          <Variable x:TypeArguments="x:Object" Name="CustomActivityStep25_1_converted" />
                          <Variable x:TypeArguments="x:Object" Name="CustomActivityStep25_3" />
                          <Variable x:TypeArguments="x:Object" Name="CustomActivityStep25_3_converted" />
                        </sco:Collection>
                        <sco:Collection x:TypeArguments="Activity" x:Key="Activities">
                          <mxswa:GetEntityProperty Attribute="cdi_tags" Entity="[CreatedEntities(&quot;CustomActivityStep1EmailTemplate_entity&quot;)]" EntityName="cdi_emailtemplate" Value="[CustomActivityStep25_2]">
                            <mxswa:GetEntityProperty.TargetType>
                              <InArgument x:TypeArguments="s:Type">
                                <mxswa:ReferenceLiteral x:TypeArguments="s:Type" Value="x:String" />
                              </InArgument>
                            </mxswa:GetEntityProperty.TargetType>
                          </mxswa:GetEntityProperty>
                          <mxswa:ActivityReference AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.EvaluateExpression, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="EvaluateExpression">
                            <mxswa:ActivityReference.Arguments>
                              <InArgument x:TypeArguments="x:String" x:Key="ExpressionOperator">SelectFirstNonNull</InArgument>
                              <InArgument x:TypeArguments="s:Object[]" x:Key="Parameters">[New Object() { CustomActivityStep25_2 }]</InArgument>
                              <InArgument x:TypeArguments="s:Type" x:Key="TargetType">
                                <mxswa:ReferenceLiteral x:TypeArguments="s:Type" Value="x:String" />
                              </InArgument>
                              <OutArgument x:TypeArguments="x:Object" x:Key="Result">[CustomActivityStep25_1]</OutArgument>
                            </mxswa:ActivityReference.Arguments>
                          </mxswa:ActivityReference>
                          <mxswa:ActivityReference AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.ConvertCrmXrmTypes, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="ConvertCrmXrmTypes">
                            <mxswa:ActivityReference.Arguments>
                              <InArgument x:TypeArguments="x:Object" x:Key="Value">[CustomActivityStep25_1]</InArgument>
                              <InArgument x:TypeArguments="s:Type" x:Key="TargetType">
                                <mxswa:ReferenceLiteral x:TypeArguments="s:Type" Value="x:String" />
                              </InArgument>
                              <OutArgument x:TypeArguments="x:Object" x:Key="Result">[CustomActivityStep25_1_converted]</OutArgument>
                            </mxswa:ActivityReference.Arguments>
                          </mxswa:ActivityReference>
                          <mxswa:ActivityReference AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.EvaluateExpression, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="EvaluateExpression">
                            <mxswa:ActivityReference.Arguments>
                              <InArgument x:TypeArguments="x:String" x:Key="ExpressionOperator">CreateCrmType</InArgument>
                              <InArgument x:TypeArguments="s:Object[]" x:Key="Parameters">[New Object() { Microsoft.Xrm.Sdk.Workflow.WorkflowPropertyType.String, "(?i)^.*Communication Consent.*$", "String" }]</InArgument>
                              <InArgument x:TypeArguments="s:Type" x:Key="TargetType">
                                <mxswa:ReferenceLiteral x:TypeArguments="s:Type" Value="x:String" />
                              </InArgument>
                              <OutArgument x:TypeArguments="x:Object" x:Key="Result">[CustomActivityStep25_3]</OutArgument>
                            </mxswa:ActivityReference.Arguments>
                          </mxswa:ActivityReference>
                          <mxswa:ActivityReference AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.ConvertCrmXrmTypes, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="ConvertCrmXrmTypes">
                            <mxswa:ActivityReference.Arguments>
                              <InArgument x:TypeArguments="x:Object" x:Key="Value">[CustomActivityStep25_3]</InArgument>
                              <InArgument x:TypeArguments="s:Type" x:Key="TargetType">
                                <mxswa:ReferenceLiteral x:TypeArguments="s:Type" Value="x:String" />
                              </InArgument>
                              <OutArgument x:TypeArguments="x:Object" x:Key="Result">[CustomActivityStep25_3_converted]</OutArgument>
                            </mxswa:ActivityReference.Arguments>
                          </mxswa:ActivityReference>
                          <mxswa:ActivityReference AssemblyQualifiedName="ManipulationLibrary.RegEx.Match, CHORUS.CRM2016.ManipulationLibrary, Version=1.0.0.1, Culture=neutral, PublicKeyToken=13c53152e32ae315" DisplayName="CustomActivityStep25: Check Tag">
                            <mxswa:ActivityReference.Arguments>
                              <InArgument x:TypeArguments="x:String" x:Key="Text">[DirectCast(CustomActivityStep25_1_converted, System.String)]</InArgument>
                              <InArgument x:TypeArguments="x:String" x:Key="Pattern">[DirectCast(CustomActivityStep25_3_converted, System.String)]</InArgument>
                              <OutArgument x:TypeArguments="x:Boolean" x:Key="InvalidRegularExpression">[CustomActivityStep25InvalidRegularExpression_localParameter]</OutArgument>
                              <OutArgument x:TypeArguments="x:Boolean" x:Key="MatchFound">[CustomActivityStep25MatchFound_localParameter]</OutArgument>
                            </mxswa:ActivityReference.Arguments>
                          </mxswa:ActivityReference>
                        </sco:Collection>
                      </mxswa:ActivityReference.Properties>
                    </mxswa:ActivityReference>
                    <mxswa:ActivityReference AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.ConditionSequence, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="ConditionStep5">
                      <mxswa:ActivityReference.Arguments>
                        <InArgument x:TypeArguments="x:Boolean" x:Key="Wait">False</InArgument>
                      </mxswa:ActivityReference.Arguments>
                      <mxswa:ActivityReference.Properties>
                        <sco:Collection x:TypeArguments="Variable" x:Key="Variables">
                          <Variable x:TypeArguments="x:Boolean" Default="False" Name="ConditionBranchStep6_condition" />
                          <Variable x:TypeArguments="x:Object" Name="ConditionBranchStep6_1" />
                        </sco:Collection>
                        <sco:Collection x:TypeArguments="Activity" x:Key="Activities">
                          <mxswa:ActivityReference AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.EvaluateExpression, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="EvaluateExpression">
                            <mxswa:ActivityReference.Arguments>
                              <InArgument x:TypeArguments="x:String" x:Key="ExpressionOperator">CreateCrmType</InArgument>
                              <InArgument x:TypeArguments="s:Object[]" x:Key="Parameters">[New Object() { Microsoft.Xrm.Sdk.Workflow.WorkflowPropertyType.Boolean, "1" }]</InArgument>
                              <InArgument x:TypeArguments="s:Type" x:Key="TargetType">
                                <mxswa:ReferenceLiteral x:TypeArguments="s:Type" Value="x:Boolean" />
                              </InArgument>
                              <OutArgument x:TypeArguments="x:Object" x:Key="Result">[ConditionBranchStep6_1]</OutArgument>
                            </mxswa:ActivityReference.Arguments>
                          </mxswa:ActivityReference>
                          <mxswa:ActivityReference AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.EvaluateCondition, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="EvaluateCondition">
                            <mxswa:ActivityReference.Arguments>
                              <InArgument x:TypeArguments="mxsq:ConditionOperator" x:Key="ConditionOperator">Equal</InArgument>
                              <InArgument x:TypeArguments="s:Object[]" x:Key="Parameters">[New Object() { ConditionBranchStep6_1 }]</InArgument>
                              <InArgument x:TypeArguments="x:Object" x:Key="Operand">[CustomActivityStep25MatchFound_localParameter]</InArgument>
                              <OutArgument x:TypeArguments="x:Boolean" x:Key="Result">[ConditionBranchStep6_condition]</OutArgument>
                            </mxswa:ActivityReference.Arguments>
                          </mxswa:ActivityReference>
                          <mxswa:ActivityReference AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.ConditionBranch, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="ConditionBranchStep6">
                            <mxswa:ActivityReference.Arguments>
                              <InArgument x:TypeArguments="x:Boolean" x:Key="Condition">[ConditionBranchStep6_condition]</InArgument>
                            </mxswa:ActivityReference.Arguments>
                            <mxswa:ActivityReference.Properties>
                              <mxswa:ActivityReference x:Key="Then" AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.Composite, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="ConditionBranchStep6">
                                <mxswa:ActivityReference.Properties>
                                  <sco:Collection x:TypeArguments="Variable" x:Key="Variables" />
                                  <sco:Collection x:TypeArguments="Activity" x:Key="Activities">
                                    <mxswa:ActivityReference AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.ConditionSequence, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="ConditionStep7: Check for Contact">
                                      <mxswa:ActivityReference.Arguments>
                                        <InArgument x:TypeArguments="x:Boolean" x:Key="Wait">False</InArgument>
                                      </mxswa:ActivityReference.Arguments>
                                      <mxswa:ActivityReference.Properties>
                                        <sco:Collection x:TypeArguments="Variable" x:Key="Variables">
                                          <Variable x:TypeArguments="x:Boolean" Default="False" Name="ConditionBranchStep8_condition" />
                                          <Variable x:TypeArguments="x:Object" Name="ConditionBranchStep8_1" />
                                        </sco:Collection>
                                        <sco:Collection x:TypeArguments="Activity" x:Key="Activities">
                                          <mxswa:GetEntityProperty Attribute="cdi_contactid" Entity="[InputEntities(&quot;primaryEntity&quot;)]" EntityName="cdi_sentemail" Value="[ConditionBranchStep8_1]">
                                            <mxswa:GetEntityProperty.TargetType>
                                              <InArgument x:TypeArguments="s:Type">
                                                <mxswa:ReferenceLiteral x:TypeArguments="s:Type">
                                                  <x:Null />
                                                </mxswa:ReferenceLiteral>
                                              </InArgument>
                                            </mxswa:GetEntityProperty.TargetType>
                                          </mxswa:GetEntityProperty>
                                          <mxswa:ActivityReference AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.EvaluateCondition, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="EvaluateCondition">
                                            <mxswa:ActivityReference.Arguments>
                                              <InArgument x:TypeArguments="mxsq:ConditionOperator" x:Key="ConditionOperator">NotNull</InArgument>
                                              <x:Null x:Key="Parameters" />
                                              <InArgument x:TypeArguments="x:Object" x:Key="Operand">[ConditionBranchStep8_1]</InArgument>
                                              <OutArgument x:TypeArguments="x:Boolean" x:Key="Result">[ConditionBranchStep8_condition]</OutArgument>
                                            </mxswa:ActivityReference.Arguments>
                                          </mxswa:ActivityReference>
                                          <mxswa:ActivityReference AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.ConditionBranch, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="ConditionBranchStep8">
                                            <mxswa:ActivityReference.Arguments>
                                              <InArgument x:TypeArguments="x:Boolean" x:Key="Condition">[ConditionBranchStep8_condition]</InArgument>
                                            </mxswa:ActivityReference.Arguments>
                                            <mxswa:ActivityReference.Properties>
                                              <mxswa:ActivityReference x:Key="Then" AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.Composite, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="ConditionBranchStep8">
                                                <mxswa:ActivityReference.Properties>
                                                  <sco:Collection x:TypeArguments="Variable" x:Key="Variables" />
                                                  <sco:Collection x:TypeArguments="Activity" x:Key="Activities">
                                                    <Sequence DisplayName="UpdateStep13: Update Contact">
                                                      <Sequence.Variables>
                                                        <Variable x:TypeArguments="x:Object" Name="UpdateStep13_1" />
                                                        <Variable x:TypeArguments="x:Object" Name="UpdateStep13_2" />
                                                        <Variable x:TypeArguments="x:Object" Name="UpdateStep13_3" />
                                                        <Variable x:TypeArguments="x:Object" Name="UpdateStep13_4" />
                                                        <Variable x:TypeArguments="x:Object" Name="UpdateStep13_5" />
                                                      </Sequence.Variables>
                                                      <Assign x:TypeArguments="mxs:Entity" To="[CreatedEntities(&quot;related_cdi_contactid#contact#Temp&quot;)]" Value="[New Entity(&quot;contact&quot;)]" />
                                                      <Assign x:TypeArguments="s:Guid" To="[CreatedEntities(&quot;related_cdi_contactid#contact#Temp&quot;).Id]" Value="[InputEntities(&quot;related_cdi_contactid#contact&quot;).Id]" />
                                                      <mxswa:GetEntityProperty Attribute="chorus_numberofrequestsforconsentsent" Entity="[InputEntities(&quot;related_cdi_contactid#contact&quot;)]" EntityName="contact" Value="[UpdateStep13_3]">
                                                        <mxswa:GetEntityProperty.TargetType>
                                                          <InArgument x:TypeArguments="s:Type">
                                                            <mxswa:ReferenceLiteral x:TypeArguments="s:Type" Value="x:Int32" />
                                                          </InArgument>
                                                        </mxswa:GetEntityProperty.TargetType>
                                                      </mxswa:GetEntityProperty>
                                                      <mxswa:ActivityReference AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.EvaluateExpression, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="EvaluateExpression">
                                                        <mxswa:ActivityReference.Arguments>
                                                          <InArgument x:TypeArguments="x:String" x:Key="ExpressionOperator">SelectFirstNonNull</InArgument>
                                                          <InArgument x:TypeArguments="s:Object[]" x:Key="Parameters">[New Object() { UpdateStep13_3 }]</InArgument>
                                                          <InArgument x:TypeArguments="s:Type" x:Key="TargetType">
                                                            <mxswa:ReferenceLiteral x:TypeArguments="s:Type" Value="x:Int32" />
                                                          </InArgument>
                                                          <OutArgument x:TypeArguments="x:Object" x:Key="Result">[UpdateStep13_2]</OutArgument>
                                                        </mxswa:ActivityReference.Arguments>
                                                      </mxswa:ActivityReference>
                                                      <mxswa:ActivityReference AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.EvaluateExpression, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="EvaluateExpression">
                                                        <mxswa:ActivityReference.Arguments>
                                                          <InArgument x:TypeArguments="x:String" x:Key="ExpressionOperator">CreateCrmType</InArgument>
                                                          <InArgument x:TypeArguments="s:Object[]" x:Key="Parameters">[New Object() { Microsoft.Xrm.Sdk.Workflow.WorkflowPropertyType.Integer, "1" }]</InArgument>
                                                          <InArgument x:TypeArguments="s:Type" x:Key="TargetType">
                                                            <mxswa:ReferenceLiteral x:TypeArguments="s:Type" Value="x:Int32" />
                                                          </InArgument>
                                                          <OutArgument x:TypeArguments="x:Object" x:Key="Result">[UpdateStep13_5]</OutArgument>
                                                        </mxswa:ActivityReference.Arguments>
                                                      </mxswa:ActivityReference>
                                                      <mxswa:ActivityReference AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.EvaluateExpression, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="EvaluateExpression">
                                                        <mxswa:ActivityReference.Arguments>
                                                          <InArgument x:TypeArguments="x:String" x:Key="ExpressionOperator">SelectFirstNonNull</InArgument>
                                                          <InArgument x:TypeArguments="s:Object[]" x:Key="Parameters">[New Object() { UpdateStep13_5 }]</InArgument>
                                                          <InArgument x:TypeArguments="s:Type" x:Key="TargetType">
                                                            <mxswa:ReferenceLiteral x:TypeArguments="s:Type" Value="x:Int32" />
                                                          </InArgument>
                                                          <OutArgument x:TypeArguments="x:Object" x:Key="Result">[UpdateStep13_4]</OutArgument>
                                                        </mxswa:ActivityReference.Arguments>
                                                      </mxswa:ActivityReference>
                                                      <mxswa:ActivityReference AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.EvaluateExpression, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="EvaluateExpression">
                                                        <mxswa:ActivityReference.Arguments>
                                                          <InArgument x:TypeArguments="x:String" x:Key="ExpressionOperator">Add</InArgument>
                                                          <InArgument x:TypeArguments="s:Object[]" x:Key="Parameters">[New Object() { UpdateStep13_2, UpdateStep13_4 }]</InArgument>
                                                          <InArgument x:TypeArguments="s:Type" x:Key="TargetType">
                                                            <mxswa:ReferenceLiteral x:TypeArguments="s:Type" Value="x:Int32" />
                                                          </InArgument>
                                                          <OutArgument x:TypeArguments="x:Object" x:Key="Result">[UpdateStep13_1]</OutArgument>
                                                        </mxswa:ActivityReference.Arguments>
                                                      </mxswa:ActivityReference>
                                                      <mxswa:SetEntityProperty Attribute="chorus_numberofrequestsforconsentsent" Entity="[CreatedEntities(&quot;related_cdi_contactid#contact#Temp&quot;)]" EntityName="contact" Value="[UpdateStep13_1]">
                                                        <mxswa:SetEntityProperty.TargetType>
                                                          <InArgument x:TypeArguments="s:Type">
                                                            <mxswa:ReferenceLiteral x:TypeArguments="s:Type" Value="x:Int32" />
                                                          </InArgument>
                                                        </mxswa:SetEntityProperty.TargetType>
                                                      </mxswa:SetEntityProperty>
                                                      <mxswa:UpdateEntity DisplayName="UpdateStep13" Entity="[CreatedEntities(&quot;related_cdi_contactid#contact#Temp&quot;)]" EntityName="contact" />
                                                      <Assign x:TypeArguments="mxs:Entity" To="[InputEntities(&quot;related_cdi_contactid#contact&quot;)]" Value="[CreatedEntities(&quot;related_cdi_contactid#contact#Temp&quot;)]" />
                                                      <Persist />
                                                    </Sequence>
                                                    <mxswa:ActivityReference AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.ConditionSequence, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="ConditionStep14: Check if last Request was earlier than this one">
                                                      <mxswa:ActivityReference.Arguments>
                                                        <InArgument x:TypeArguments="x:Boolean" x:Key="Wait">False</InArgument>
                                                      </mxswa:ActivityReference.Arguments>
                                                      <mxswa:ActivityReference.Properties>
                                                        <sco:Collection x:TypeArguments="Variable" x:Key="Variables">
                                                          <Variable x:TypeArguments="x:Boolean" Default="False" Name="ConditionBranchStep15_condition" />
                                                          <Variable x:TypeArguments="x:Boolean" Default="False" Name="ConditionBranchStep15_1" />
                                                          <Variable x:TypeArguments="x:Object" Name="ConditionBranchStep15_2" />
                                                          <Variable x:TypeArguments="x:Object" Name="ConditionBranchStep15_3" />
                                                          <Variable x:TypeArguments="x:Boolean" Default="False" Name="ConditionBranchStep15_4" />
                                                          <Variable x:TypeArguments="x:Object" Name="ConditionBranchStep15_5" />
                                                        </sco:Collection>
                                                        <sco:Collection x:TypeArguments="Activity" x:Key="Activities">
                                                          <mxswa:GetEntityProperty Attribute="cdi_senton" Entity="[InputEntities(&quot;primaryEntity&quot;)]" EntityName="cdi_sentemail" Value="[ConditionBranchStep15_2]">
                                                            <mxswa:GetEntityProperty.TargetType>
                                                              <InArgument x:TypeArguments="s:Type">
                                                                <mxswa:ReferenceLiteral x:TypeArguments="s:Type">
                                                                  <x:Null />
                                                                </mxswa:ReferenceLiteral>
                                                              </InArgument>
                                                            </mxswa:GetEntityProperty.TargetType>
                                                          </mxswa:GetEntityProperty>
                                                          <mxswa:GetEntityProperty Attribute="chorus_lastrequestforconsentsenton" Entity="[InputEntities(&quot;related_cdi_contactid#contact&quot;)]" EntityName="contact" Value="[ConditionBranchStep15_3]">
                                                            <mxswa:GetEntityProperty.TargetType>
                                                              <InArgument x:TypeArguments="s:Type">
                                                                <mxswa:ReferenceLiteral x:TypeArguments="s:Type">
                                                                  <x:Null />
                                                                </mxswa:ReferenceLiteral>
                                                              </InArgument>
                                                            </mxswa:GetEntityProperty.TargetType>
                                                          </mxswa:GetEntityProperty>
                                                          <mxswa:ActivityReference AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.EvaluateCondition, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="EvaluateCondition">
                                                            <mxswa:ActivityReference.Arguments>
                                                              <InArgument x:TypeArguments="mxsq:ConditionOperator" x:Key="ConditionOperator">GreaterThan</InArgument>
                                                              <InArgument x:TypeArguments="s:Object[]" x:Key="Parameters">[New Object() { ConditionBranchStep15_3 }]</InArgument>
                                                              <InArgument x:TypeArguments="x:Object" x:Key="Operand">[ConditionBranchStep15_2]</InArgument>
                                                              <OutArgument x:TypeArguments="x:Boolean" x:Key="Result">[ConditionBranchStep15_1]</OutArgument>
                                                            </mxswa:ActivityReference.Arguments>
                                                          </mxswa:ActivityReference>
                                                          <mxswa:GetEntityProperty Attribute="chorus_lastrequestforconsentsenton" Entity="[InputEntities(&quot;related_cdi_contactid#contact&quot;)]" EntityName="contact" Value="[ConditionBranchStep15_5]">
                                                            <mxswa:GetEntityProperty.TargetType>
                                                              <InArgument x:TypeArguments="s:Type">
                                                                <mxswa:ReferenceLiteral x:TypeArguments="s:Type">
                                                                  <x:Null />
                                                                </mxswa:ReferenceLiteral>
                                                              </InArgument>
                                                            </mxswa:GetEntityProperty.TargetType>
                                                          </mxswa:GetEntityProperty>
                                                          <mxswa:ActivityReference AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.EvaluateCondition, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="EvaluateCondition">
                                                            <mxswa:ActivityReference.Arguments>
                                                              <InArgument x:TypeArguments="mxsq:ConditionOperator" x:Key="ConditionOperator">Null</InArgument>
                                                              <x:Null x:Key="Parameters" />
                                                              <InArgument x:TypeArguments="x:Object" x:Key="Operand">[ConditionBranchStep15_5]</InArgument>
                                                              <OutArgument x:TypeArguments="x:Boolean" x:Key="Result">[ConditionBranchStep15_4]</OutArgument>
                                                            </mxswa:ActivityReference.Arguments>
                                                          </mxswa:ActivityReference>
                                                          <mxswa:ActivityReference AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.EvaluateLogicalCondition, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="EvaluateLogicalCondition">
                                                            <mxswa:ActivityReference.Arguments>
                                                              <InArgument x:TypeArguments="mxsq:LogicalOperator" x:Key="LogicalOperator">Or</InArgument>
                                                              <InArgument x:TypeArguments="x:Boolean" x:Key="LeftOperand">[ConditionBranchStep15_1]</InArgument>
                                                              <InArgument x:TypeArguments="x:Boolean" x:Key="RightOperand">[ConditionBranchStep15_4]</InArgument>
                                                              <OutArgument x:TypeArguments="x:Boolean" x:Key="Result">[ConditionBranchStep15_condition]</OutArgument>
                                                            </mxswa:ActivityReference.Arguments>
                                                          </mxswa:ActivityReference>
                                                          <mxswa:ActivityReference AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.ConditionBranch, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="ConditionBranchStep15">
                                                            <mxswa:ActivityReference.Arguments>
                                                              <InArgument x:TypeArguments="x:Boolean" x:Key="Condition">[ConditionBranchStep15_condition]</InArgument>
                                                            </mxswa:ActivityReference.Arguments>
                                                            <mxswa:ActivityReference.Properties>
                                                              <mxswa:ActivityReference x:Key="Then" AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.Composite, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="ConditionBranchStep15">
                                                                <mxswa:ActivityReference.Properties>
                                                                  <sco:Collection x:TypeArguments="Variable" x:Key="Variables" />
                                                                  <sco:Collection x:TypeArguments="Activity" x:Key="Activities">
                                                                    <Sequence DisplayName="UpdateStep22">
                                                                      <Sequence.Variables>
                                                                        <Variable x:TypeArguments="x:Object" Name="UpdateStep22_1" />
                                                                        <Variable x:TypeArguments="x:Object" Name="UpdateStep22_2" />
                                                                      </Sequence.Variables>
                                                                      <Assign x:TypeArguments="mxs:Entity" To="[CreatedEntities(&quot;related_cdi_contactid#contact#Temp&quot;)]" Value="[New Entity(&quot;contact&quot;)]" />
                                                                      <Assign x:TypeArguments="s:Guid" To="[CreatedEntities(&quot;related_cdi_contactid#contact#Temp&quot;).Id]" Value="[InputEntities(&quot;related_cdi_contactid#contact&quot;).Id]" />
                                                                      <mxswa:GetEntityProperty Attribute="cdi_senton" Entity="[InputEntities(&quot;primaryEntity&quot;)]" EntityName="cdi_sentemail" Value="[UpdateStep22_2]">
                                                                        <mxswa:GetEntityProperty.TargetType>
                                                                          <InArgument x:TypeArguments="s:Type">
                                                                            <mxswa:ReferenceLiteral x:TypeArguments="s:Type" Value="s:DateTime" />
                                                                          </InArgument>
                                                                        </mxswa:GetEntityProperty.TargetType>
                                                                      </mxswa:GetEntityProperty>
                                                                      <mxswa:ActivityReference AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.EvaluateExpression, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="EvaluateExpression">
                                                                        <mxswa:ActivityReference.Arguments>
                                                                          <InArgument x:TypeArguments="x:String" x:Key="ExpressionOperator">SelectFirstNonNull</InArgument>
                                                                          <InArgument x:TypeArguments="s:Object[]" x:Key="Parameters">[New Object() { UpdateStep22_2 }]</InArgument>
                                                                          <InArgument x:TypeArguments="s:Type" x:Key="TargetType">
                                                                            <mxswa:ReferenceLiteral x:TypeArguments="s:Type" Value="s:DateTime" />
                                                                          </InArgument>
                                                                          <OutArgument x:TypeArguments="x:Object" x:Key="Result">[UpdateStep22_1]</OutArgument>
                                                                        </mxswa:ActivityReference.Arguments>
                                                                      </mxswa:ActivityReference>
                                                                      <mxswa:SetEntityProperty Attribute="chorus_lastrequestforconsentsenton" Entity="[CreatedEntities(&quot;related_cdi_contactid#contact#Temp&quot;)]" EntityName="contact" Value="[UpdateStep22_1]">
                                                                        <mxswa:SetEntityProperty.TargetType>
                                                                          <InArgument x:TypeArguments="s:Type">
                                                                            <mxswa:ReferenceLiteral x:TypeArguments="s:Type" Value="s:DateTime" />
                                                                          </InArgument>
                                                                        </mxswa:SetEntityProperty.TargetType>
                                                                      </mxswa:SetEntityProperty>
                                                                      <mxswa:UpdateEntity DisplayName="UpdateStep22" Entity="[CreatedEntities(&quot;related_cdi_contactid#contact#Temp&quot;)]" EntityName="contact" />
                                                                      <Assign x:TypeArguments="mxs:Entity" To="[InputEntities(&quot;related_cdi_contactid#contact&quot;)]" Value="[CreatedEntities(&quot;related_cdi_contactid#contact#Temp&quot;)]" />
                                                                      <Persist />
                                                                    </Sequence>
                                                                  </sco:Collection>
                                                                </mxswa:ActivityReference.Properties>
                                                              </mxswa:ActivityReference>
                                                              <x:Null x:Key="Else" />
                                                              <x:Null x:Key="Description" />
                                                            </mxswa:ActivityReference.Properties>
                                                          </mxswa:ActivityReference>
                                                        </sco:Collection>
                                                        <x:Boolean x:Key="ContainsElseBranch">False</x:Boolean>
                                                      </mxswa:ActivityReference.Properties>
                                                    </mxswa:ActivityReference>
                                                  </sco:Collection>
                                                </mxswa:ActivityReference.Properties>
                                              </mxswa:ActivityReference>
                                              <x:Null x:Key="Else" />
                                              <x:Null x:Key="Description" />
                                            </mxswa:ActivityReference.Properties>
                                          </mxswa:ActivityReference>
                                        </sco:Collection>
                                        <x:Boolean x:Key="ContainsElseBranch">False</x:Boolean>
                                      </mxswa:ActivityReference.Properties>
                                    </mxswa:ActivityReference>
                                    <mxswa:ActivityReference AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.ConditionSequence, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="ConditionStep9: Check for Account">
                                      <mxswa:ActivityReference.Arguments>
                                        <InArgument x:TypeArguments="x:Boolean" x:Key="Wait">False</InArgument>
                                      </mxswa:ActivityReference.Arguments>
                                      <mxswa:ActivityReference.Properties>
                                        <sco:Collection x:TypeArguments="Variable" x:Key="Variables">
                                          <Variable x:TypeArguments="x:Boolean" Default="False" Name="ConditionBranchStep10_condition" />
                                          <Variable x:TypeArguments="x:Object" Name="ConditionBranchStep10_1" />
                                        </sco:Collection>
                                        <sco:Collection x:TypeArguments="Activity" x:Key="Activities">
                                          <mxswa:GetEntityProperty Attribute="cdi_accountid" Entity="[InputEntities(&quot;primaryEntity&quot;)]" EntityName="cdi_sentemail" Value="[ConditionBranchStep10_1]">
                                            <mxswa:GetEntityProperty.TargetType>
                                              <InArgument x:TypeArguments="s:Type">
                                                <mxswa:ReferenceLiteral x:TypeArguments="s:Type">
                                                  <x:Null />
                                                </mxswa:ReferenceLiteral>
                                              </InArgument>
                                            </mxswa:GetEntityProperty.TargetType>
                                          </mxswa:GetEntityProperty>
                                          <mxswa:ActivityReference AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.EvaluateCondition, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="EvaluateCondition">
                                            <mxswa:ActivityReference.Arguments>
                                              <InArgument x:TypeArguments="mxsq:ConditionOperator" x:Key="ConditionOperator">NotNull</InArgument>
                                              <x:Null x:Key="Parameters" />
                                              <InArgument x:TypeArguments="x:Object" x:Key="Operand">[ConditionBranchStep10_1]</InArgument>
                                              <OutArgument x:TypeArguments="x:Boolean" x:Key="Result">[ConditionBranchStep10_condition]</OutArgument>
                                            </mxswa:ActivityReference.Arguments>
                                          </mxswa:ActivityReference>
                                          <mxswa:ActivityReference AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.ConditionBranch, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="ConditionBranchStep10">
                                            <mxswa:ActivityReference.Arguments>
                                              <InArgument x:TypeArguments="x:Boolean" x:Key="Condition">[ConditionBranchStep10_condition]</InArgument>
                                            </mxswa:ActivityReference.Arguments>
                                            <mxswa:ActivityReference.Properties>
                                              <mxswa:ActivityReference x:Key="Then" AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.Composite, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="ConditionBranchStep10">
                                                <mxswa:ActivityReference.Properties>
                                                  <sco:Collection x:TypeArguments="Variable" x:Key="Variables" />
                                                  <sco:Collection x:TypeArguments="Activity" x:Key="Activities">
                                                    <Sequence DisplayName="UpdateStep16: Update Account">
                                                      <Sequence.Variables>
                                                        <Variable x:TypeArguments="x:Object" Name="UpdateStep16_1" />
                                                        <Variable x:TypeArguments="x:Object" Name="UpdateStep16_2" />
                                                        <Variable x:TypeArguments="x:Object" Name="UpdateStep16_3" />
                                                        <Variable x:TypeArguments="x:Object" Name="UpdateStep16_4" />
                                                        <Variable x:TypeArguments="x:Object" Name="UpdateStep16_5" />
                                                      </Sequence.Variables>
                                                      <Assign x:TypeArguments="mxs:Entity" To="[CreatedEntities(&quot;related_cdi_accountid#account#Temp&quot;)]" Value="[New Entity(&quot;account&quot;)]" />
                                                      <Assign x:TypeArguments="s:Guid" To="[CreatedEntities(&quot;related_cdi_accountid#account#Temp&quot;).Id]" Value="[InputEntities(&quot;related_cdi_accountid#account&quot;).Id]" />
                                                      <mxswa:GetEntityProperty Attribute="chorus_numberofrequestsforconsentsent" Entity="[InputEntities(&quot;related_cdi_accountid#account&quot;)]" EntityName="account" Value="[UpdateStep16_3]">
                                                        <mxswa:GetEntityProperty.TargetType>
                                                          <InArgument x:TypeArguments="s:Type">
                                                            <mxswa:ReferenceLiteral x:TypeArguments="s:Type" Value="x:Int32" />
                                                          </InArgument>
                                                        </mxswa:GetEntityProperty.TargetType>
                                                      </mxswa:GetEntityProperty>
                                                      <mxswa:ActivityReference AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.EvaluateExpression, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="EvaluateExpression">
                                                        <mxswa:ActivityReference.Arguments>
                                                          <InArgument x:TypeArguments="x:String" x:Key="ExpressionOperator">SelectFirstNonNull</InArgument>
                                                          <InArgument x:TypeArguments="s:Object[]" x:Key="Parameters">[New Object() { UpdateStep16_3 }]</InArgument>
                                                          <InArgument x:TypeArguments="s:Type" x:Key="TargetType">
                                                            <mxswa:ReferenceLiteral x:TypeArguments="s:Type" Value="x:Int32" />
                                                          </InArgument>
                                                          <OutArgument x:TypeArguments="x:Object" x:Key="Result">[UpdateStep16_2]</OutArgument>
                                                        </mxswa:ActivityReference.Arguments>
                                                      </mxswa:ActivityReference>
                                                      <mxswa:ActivityReference AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.EvaluateExpression, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="EvaluateExpression">
                                                        <mxswa:ActivityReference.Arguments>
                                                          <InArgument x:TypeArguments="x:String" x:Key="ExpressionOperator">CreateCrmType</InArgument>
                                                          <InArgument x:TypeArguments="s:Object[]" x:Key="Parameters">[New Object() { Microsoft.Xrm.Sdk.Workflow.WorkflowPropertyType.Integer, "1" }]</InArgument>
                                                          <InArgument x:TypeArguments="s:Type" x:Key="TargetType">
                                                            <mxswa:ReferenceLiteral x:TypeArguments="s:Type" Value="x:Int32" />
                                                          </InArgument>
                                                          <OutArgument x:TypeArguments="x:Object" x:Key="Result">[UpdateStep16_5]</OutArgument>
                                                        </mxswa:ActivityReference.Arguments>
                                                      </mxswa:ActivityReference>
                                                      <mxswa:ActivityReference AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.EvaluateExpression, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="EvaluateExpression">
                                                        <mxswa:ActivityReference.Arguments>
                                                          <InArgument x:TypeArguments="x:String" x:Key="ExpressionOperator">SelectFirstNonNull</InArgument>
                                                          <InArgument x:TypeArguments="s:Object[]" x:Key="Parameters">[New Object() { UpdateStep16_5 }]</InArgument>
                                                          <InArgument x:TypeArguments="s:Type" x:Key="TargetType">
                                                            <mxswa:ReferenceLiteral x:TypeArguments="s:Type" Value="x:Int32" />
                                                          </InArgument>
                                                          <OutArgument x:TypeArguments="x:Object" x:Key="Result">[UpdateStep16_4]</OutArgument>
                                                        </mxswa:ActivityReference.Arguments>
                                                      </mxswa:ActivityReference>
                                                      <mxswa:ActivityReference AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.EvaluateExpression, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="EvaluateExpression">
                                                        <mxswa:ActivityReference.Arguments>
                                                          <InArgument x:TypeArguments="x:String" x:Key="ExpressionOperator">Add</InArgument>
                                                          <InArgument x:TypeArguments="s:Object[]" x:Key="Parameters">[New Object() { UpdateStep16_2, UpdateStep16_4 }]</InArgument>
                                                          <InArgument x:TypeArguments="s:Type" x:Key="TargetType">
                                                            <mxswa:ReferenceLiteral x:TypeArguments="s:Type" Value="x:Int32" />
                                                          </InArgument>
                                                          <OutArgument x:TypeArguments="x:Object" x:Key="Result">[UpdateStep16_1]</OutArgument>
                                                        </mxswa:ActivityReference.Arguments>
                                                      </mxswa:ActivityReference>
                                                      <mxswa:SetEntityProperty Attribute="chorus_numberofrequestsforconsentsent" Entity="[CreatedEntities(&quot;related_cdi_accountid#account#Temp&quot;)]" EntityName="account" Value="[UpdateStep16_1]">
                                                        <mxswa:SetEntityProperty.TargetType>
                                                          <InArgument x:TypeArguments="s:Type">
                                                            <mxswa:ReferenceLiteral x:TypeArguments="s:Type" Value="x:Int32" />
                                                          </InArgument>
                                                        </mxswa:SetEntityProperty.TargetType>
                                                      </mxswa:SetEntityProperty>
                                                      <mxswa:UpdateEntity DisplayName="UpdateStep16" Entity="[CreatedEntities(&quot;related_cdi_accountid#account#Temp&quot;)]" EntityName="account" />
                                                      <Assign x:TypeArguments="mxs:Entity" To="[InputEntities(&quot;related_cdi_accountid#account&quot;)]" Value="[CreatedEntities(&quot;related_cdi_accountid#account#Temp&quot;)]" />
                                                      <Persist />
                                                    </Sequence>
                                                    <mxswa:ActivityReference AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.ConditionSequence, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="ConditionStep17: Check if last Request was earlier than this one">
                                                      <mxswa:ActivityReference.Arguments>
                                                        <InArgument x:TypeArguments="x:Boolean" x:Key="Wait">False</InArgument>
                                                      </mxswa:ActivityReference.Arguments>
                                                      <mxswa:ActivityReference.Properties>
                                                        <sco:Collection x:TypeArguments="Variable" x:Key="Variables">
                                                          <Variable x:TypeArguments="x:Boolean" Default="False" Name="ConditionBranchStep18_condition" />
                                                          <Variable x:TypeArguments="x:Boolean" Default="False" Name="ConditionBranchStep18_1" />
                                                          <Variable x:TypeArguments="x:Object" Name="ConditionBranchStep18_2" />
                                                          <Variable x:TypeArguments="x:Object" Name="ConditionBranchStep18_3" />
                                                          <Variable x:TypeArguments="x:Boolean" Default="False" Name="ConditionBranchStep18_4" />
                                                          <Variable x:TypeArguments="x:Object" Name="ConditionBranchStep18_5" />
                                                        </sco:Collection>
                                                        <sco:Collection x:TypeArguments="Activity" x:Key="Activities">
                                                          <mxswa:GetEntityProperty Attribute="cdi_senton" Entity="[InputEntities(&quot;primaryEntity&quot;)]" EntityName="cdi_sentemail" Value="[ConditionBranchStep18_2]">
                                                            <mxswa:GetEntityProperty.TargetType>
                                                              <InArgument x:TypeArguments="s:Type">
                                                                <mxswa:ReferenceLiteral x:TypeArguments="s:Type">
                                                                  <x:Null />
                                                                </mxswa:ReferenceLiteral>
                                                              </InArgument>
                                                            </mxswa:GetEntityProperty.TargetType>
                                                          </mxswa:GetEntityProperty>
                                                          <mxswa:GetEntityProperty Attribute="chorus_lastrequestforconsentsenton" Entity="[InputEntities(&quot;related_cdi_accountid#account&quot;)]" EntityName="account" Value="[ConditionBranchStep18_3]">
                                                            <mxswa:GetEntityProperty.TargetType>
                                                              <InArgument x:TypeArguments="s:Type">
                                                                <mxswa:ReferenceLiteral x:TypeArguments="s:Type">
                                                                  <x:Null />
                                                                </mxswa:ReferenceLiteral>
                                                              </InArgument>
                                                            </mxswa:GetEntityProperty.TargetType>
                                                          </mxswa:GetEntityProperty>
                                                          <mxswa:ActivityReference AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.EvaluateCondition, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="EvaluateCondition">
                                                            <mxswa:ActivityReference.Arguments>
                                                              <InArgument x:TypeArguments="mxsq:ConditionOperator" x:Key="ConditionOperator">GreaterThan</InArgument>
                                                              <InArgument x:TypeArguments="s:Object[]" x:Key="Parameters">[New Object() { ConditionBranchStep18_3 }]</InArgument>
                                                              <InArgument x:TypeArguments="x:Object" x:Key="Operand">[ConditionBranchStep18_2]</InArgument>
                                                              <OutArgument x:TypeArguments="x:Boolean" x:Key="Result">[ConditionBranchStep18_1]</OutArgument>
                                                            </mxswa:ActivityReference.Arguments>
                                                          </mxswa:ActivityReference>
                                                          <mxswa:GetEntityProperty Attribute="chorus_lastrequestforconsentsenton" Entity="[InputEntities(&quot;related_cdi_accountid#account&quot;)]" EntityName="account" Value="[ConditionBranchStep18_5]">
                                                            <mxswa:GetEntityProperty.TargetType>
                                                              <InArgument x:TypeArguments="s:Type">
                                                                <mxswa:ReferenceLiteral x:TypeArguments="s:Type">
                                                                  <x:Null />
                                                                </mxswa:ReferenceLiteral>
                                                              </InArgument>
                                                            </mxswa:GetEntityProperty.TargetType>
                                                          </mxswa:GetEntityProperty>
                                                          <mxswa:ActivityReference AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.EvaluateCondition, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="EvaluateCondition">
                                                            <mxswa:ActivityReference.Arguments>
                                                              <InArgument x:TypeArguments="mxsq:ConditionOperator" x:Key="ConditionOperator">Null</InArgument>
                                                              <x:Null x:Key="Parameters" />
                                                              <InArgument x:TypeArguments="x:Object" x:Key="Operand">[ConditionBranchStep18_5]</InArgument>
                                                              <OutArgument x:TypeArguments="x:Boolean" x:Key="Result">[ConditionBranchStep18_4]</OutArgument>
                                                            </mxswa:ActivityReference.Arguments>
                                                          </mxswa:ActivityReference>
                                                          <mxswa:ActivityReference AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.EvaluateLogicalCondition, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="EvaluateLogicalCondition">
                                                            <mxswa:ActivityReference.Arguments>
                                                              <InArgument x:TypeArguments="mxsq:LogicalOperator" x:Key="LogicalOperator">Or</InArgument>
                                                              <InArgument x:TypeArguments="x:Boolean" x:Key="LeftOperand">[ConditionBranchStep18_1]</InArgument>
                                                              <InArgument x:TypeArguments="x:Boolean" x:Key="RightOperand">[ConditionBranchStep18_4]</InArgument>
                                                              <OutArgument x:TypeArguments="x:Boolean" x:Key="Result">[ConditionBranchStep18_condition]</OutArgument>
                                                            </mxswa:ActivityReference.Arguments>
                                                          </mxswa:ActivityReference>
                                                          <mxswa:ActivityReference AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.ConditionBranch, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="ConditionBranchStep18">
                                                            <mxswa:ActivityReference.Arguments>
                                                              <InArgument x:TypeArguments="x:Boolean" x:Key="Condition">[ConditionBranchStep18_condition]</InArgument>
                                                            </mxswa:ActivityReference.Arguments>
                                                            <mxswa:ActivityReference.Properties>
                                                              <mxswa:ActivityReference x:Key="Then" AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.Composite, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="ConditionBranchStep18">
                                                                <mxswa:ActivityReference.Properties>
                                                                  <sco:Collection x:TypeArguments="Variable" x:Key="Variables" />
                                                                  <sco:Collection x:TypeArguments="Activity" x:Key="Activities">
                                                                    <Sequence DisplayName="UpdateStep23">
                                                                      <Sequence.Variables>
                                                                        <Variable x:TypeArguments="x:Object" Name="UpdateStep23_1" />
                                                                        <Variable x:TypeArguments="x:Object" Name="UpdateStep23_2" />
                                                                      </Sequence.Variables>
                                                                      <Assign x:TypeArguments="mxs:Entity" To="[CreatedEntities(&quot;related_cdi_accountid#account#Temp&quot;)]" Value="[New Entity(&quot;account&quot;)]" />
                                                                      <Assign x:TypeArguments="s:Guid" To="[CreatedEntities(&quot;related_cdi_accountid#account#Temp&quot;).Id]" Value="[InputEntities(&quot;related_cdi_accountid#account&quot;).Id]" />
                                                                      <mxswa:GetEntityProperty Attribute="cdi_senton" Entity="[InputEntities(&quot;primaryEntity&quot;)]" EntityName="cdi_sentemail" Value="[UpdateStep23_2]">
                                                                        <mxswa:GetEntityProperty.TargetType>
                                                                          <InArgument x:TypeArguments="s:Type">
                                                                            <mxswa:ReferenceLiteral x:TypeArguments="s:Type" Value="s:DateTime" />
                                                                          </InArgument>
                                                                        </mxswa:GetEntityProperty.TargetType>
                                                                      </mxswa:GetEntityProperty>
                                                                      <mxswa:ActivityReference AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.EvaluateExpression, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="EvaluateExpression">
                                                                        <mxswa:ActivityReference.Arguments>
                                                                          <InArgument x:TypeArguments="x:String" x:Key="ExpressionOperator">SelectFirstNonNull</InArgument>
                                                                          <InArgument x:TypeArguments="s:Object[]" x:Key="Parameters">[New Object() { UpdateStep23_2 }]</InArgument>
                                                                          <InArgument x:TypeArguments="s:Type" x:Key="TargetType">
                                                                            <mxswa:ReferenceLiteral x:TypeArguments="s:Type" Value="s:DateTime" />
                                                                          </InArgument>
                                                                          <OutArgument x:TypeArguments="x:Object" x:Key="Result">[UpdateStep23_1]</OutArgument>
                                                                        </mxswa:ActivityReference.Arguments>
                                                                      </mxswa:ActivityReference>
                                                                      <mxswa:SetEntityProperty Attribute="chorus_lastrequestforconsentsenton" Entity="[CreatedEntities(&quot;related_cdi_accountid#account#Temp&quot;)]" EntityName="account" Value="[UpdateStep23_1]">
                                                                        <mxswa:SetEntityProperty.TargetType>
                                                                          <InArgument x:TypeArguments="s:Type">
                                                                            <mxswa:ReferenceLiteral x:TypeArguments="s:Type" Value="s:DateTime" />
                                                                          </InArgument>
                                                                        </mxswa:SetEntityProperty.TargetType>
                                                                      </mxswa:SetEntityProperty>
                                                                      <mxswa:UpdateEntity DisplayName="UpdateStep23" Entity="[CreatedEntities(&quot;related_cdi_accountid#account#Temp&quot;)]" EntityName="account" />
                                                                      <Assign x:TypeArguments="mxs:Entity" To="[InputEntities(&quot;related_cdi_accountid#account&quot;)]" Value="[CreatedEntities(&quot;related_cdi_accountid#account#Temp&quot;)]" />
                                                                      <Persist />
                                                                    </Sequence>
                                                                  </sco:Collection>
                                                                </mxswa:ActivityReference.Properties>
                                                              </mxswa:ActivityReference>
                                                              <x:Null x:Key="Else" />
                                                              <x:Null x:Key="Description" />
                                                            </mxswa:ActivityReference.Properties>
                                                          </mxswa:ActivityReference>
                                                        </sco:Collection>
                                                        <x:Boolean x:Key="ContainsElseBranch">False</x:Boolean>
                                                      </mxswa:ActivityReference.Properties>
                                                    </mxswa:ActivityReference>
                                                  </sco:Collection>
                                                </mxswa:ActivityReference.Properties>
                                              </mxswa:ActivityReference>
                                              <x:Null x:Key="Else" />
                                              <x:Null x:Key="Description" />
                                            </mxswa:ActivityReference.Properties>
                                          </mxswa:ActivityReference>
                                        </sco:Collection>
                                        <x:Boolean x:Key="ContainsElseBranch">False</x:Boolean>
                                      </mxswa:ActivityReference.Properties>
                                    </mxswa:ActivityReference>
                                    <mxswa:ActivityReference AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.ConditionSequence, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="ConditionStep11: Check for Lead">
                                      <mxswa:ActivityReference.Arguments>
                                        <InArgument x:TypeArguments="x:Boolean" x:Key="Wait">False</InArgument>
                                      </mxswa:ActivityReference.Arguments>
                                      <mxswa:ActivityReference.Properties>
                                        <sco:Collection x:TypeArguments="Variable" x:Key="Variables">
                                          <Variable x:TypeArguments="x:Boolean" Default="False" Name="ConditionBranchStep12_condition" />
                                          <Variable x:TypeArguments="x:Object" Name="ConditionBranchStep12_1" />
                                        </sco:Collection>
                                        <sco:Collection x:TypeArguments="Activity" x:Key="Activities">
                                          <mxswa:GetEntityProperty Attribute="cdi_leadid" Entity="[InputEntities(&quot;primaryEntity&quot;)]" EntityName="cdi_sentemail" Value="[ConditionBranchStep12_1]">
                                            <mxswa:GetEntityProperty.TargetType>
                                              <InArgument x:TypeArguments="s:Type">
                                                <mxswa:ReferenceLiteral x:TypeArguments="s:Type">
                                                  <x:Null />
                                                </mxswa:ReferenceLiteral>
                                              </InArgument>
                                            </mxswa:GetEntityProperty.TargetType>
                                          </mxswa:GetEntityProperty>
                                          <mxswa:ActivityReference AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.EvaluateCondition, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="EvaluateCondition">
                                            <mxswa:ActivityReference.Arguments>
                                              <InArgument x:TypeArguments="mxsq:ConditionOperator" x:Key="ConditionOperator">NotNull</InArgument>
                                              <x:Null x:Key="Parameters" />
                                              <InArgument x:TypeArguments="x:Object" x:Key="Operand">[ConditionBranchStep12_1]</InArgument>
                                              <OutArgument x:TypeArguments="x:Boolean" x:Key="Result">[ConditionBranchStep12_condition]</OutArgument>
                                            </mxswa:ActivityReference.Arguments>
                                          </mxswa:ActivityReference>
                                          <mxswa:ActivityReference AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.ConditionBranch, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="ConditionBranchStep12">
                                            <mxswa:ActivityReference.Arguments>
                                              <InArgument x:TypeArguments="x:Boolean" x:Key="Condition">[ConditionBranchStep12_condition]</InArgument>
                                            </mxswa:ActivityReference.Arguments>
                                            <mxswa:ActivityReference.Properties>
                                              <mxswa:ActivityReference x:Key="Then" AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.Composite, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="ConditionBranchStep12">
                                                <mxswa:ActivityReference.Properties>
                                                  <sco:Collection x:TypeArguments="Variable" x:Key="Variables" />
                                                  <sco:Collection x:TypeArguments="Activity" x:Key="Activities">
                                                    <Sequence DisplayName="UpdateStep19: Update Lead">
                                                      <Sequence.Variables>
                                                        <Variable x:TypeArguments="x:Object" Name="UpdateStep19_1" />
                                                        <Variable x:TypeArguments="x:Object" Name="UpdateStep19_2" />
                                                        <Variable x:TypeArguments="x:Object" Name="UpdateStep19_3" />
                                                        <Variable x:TypeArguments="x:Object" Name="UpdateStep19_4" />
                                                        <Variable x:TypeArguments="x:Object" Name="UpdateStep19_5" />
                                                      </Sequence.Variables>
                                                      <Assign x:TypeArguments="mxs:Entity" To="[CreatedEntities(&quot;related_cdi_leadid#lead#Temp&quot;)]" Value="[New Entity(&quot;lead&quot;)]" />
                                                      <Assign x:TypeArguments="s:Guid" To="[CreatedEntities(&quot;related_cdi_leadid#lead#Temp&quot;).Id]" Value="[InputEntities(&quot;related_cdi_leadid#lead&quot;).Id]" />
                                                      <mxswa:GetEntityProperty Attribute="chorus_numberofrequestsforconsentsent" Entity="[InputEntities(&quot;related_cdi_leadid#lead&quot;)]" EntityName="lead" Value="[UpdateStep19_3]">
                                                        <mxswa:GetEntityProperty.TargetType>
                                                          <InArgument x:TypeArguments="s:Type">
                                                            <mxswa:ReferenceLiteral x:TypeArguments="s:Type" Value="x:Int32" />
                                                          </InArgument>
                                                        </mxswa:GetEntityProperty.TargetType>
                                                      </mxswa:GetEntityProperty>
                                                      <mxswa:ActivityReference AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.EvaluateExpression, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="EvaluateExpression">
                                                        <mxswa:ActivityReference.Arguments>
                                                          <InArgument x:TypeArguments="x:String" x:Key="ExpressionOperator">SelectFirstNonNull</InArgument>
                                                          <InArgument x:TypeArguments="s:Object[]" x:Key="Parameters">[New Object() { UpdateStep19_3 }]</InArgument>
                                                          <InArgument x:TypeArguments="s:Type" x:Key="TargetType">
                                                            <mxswa:ReferenceLiteral x:TypeArguments="s:Type" Value="x:Int32" />
                                                          </InArgument>
                                                          <OutArgument x:TypeArguments="x:Object" x:Key="Result">[UpdateStep19_2]</OutArgument>
                                                        </mxswa:ActivityReference.Arguments>
                                                      </mxswa:ActivityReference>
                                                      <mxswa:ActivityReference AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.EvaluateExpression, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="EvaluateExpression">
                                                        <mxswa:ActivityReference.Arguments>
                                                          <InArgument x:TypeArguments="x:String" x:Key="ExpressionOperator">CreateCrmType</InArgument>
                                                          <InArgument x:TypeArguments="s:Object[]" x:Key="Parameters">[New Object() { Microsoft.Xrm.Sdk.Workflow.WorkflowPropertyType.Integer, "1" }]</InArgument>
                                                          <InArgument x:TypeArguments="s:Type" x:Key="TargetType">
                                                            <mxswa:ReferenceLiteral x:TypeArguments="s:Type" Value="x:Int32" />
                                                          </InArgument>
                                                          <OutArgument x:TypeArguments="x:Object" x:Key="Result">[UpdateStep19_5]</OutArgument>
                                                        </mxswa:ActivityReference.Arguments>
                                                      </mxswa:ActivityReference>
                                                      <mxswa:ActivityReference AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.EvaluateExpression, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="EvaluateExpression">
                                                        <mxswa:ActivityReference.Arguments>
                                                          <InArgument x:TypeArguments="x:String" x:Key="ExpressionOperator">SelectFirstNonNull</InArgument>
                                                          <InArgument x:TypeArguments="s:Object[]" x:Key="Parameters">[New Object() { UpdateStep19_5 }]</InArgument>
                                                          <InArgument x:TypeArguments="s:Type" x:Key="TargetType">
                                                            <mxswa:ReferenceLiteral x:TypeArguments="s:Type" Value="x:Int32" />
                                                          </InArgument>
                                                          <OutArgument x:TypeArguments="x:Object" x:Key="Result">[UpdateStep19_4]</OutArgument>
                                                        </mxswa:ActivityReference.Arguments>
                                                      </mxswa:ActivityReference>
                                                      <mxswa:ActivityReference AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.EvaluateExpression, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="EvaluateExpression">
                                                        <mxswa:ActivityReference.Arguments>
                                                          <InArgument x:TypeArguments="x:String" x:Key="ExpressionOperator">Add</InArgument>
                                                          <InArgument x:TypeArguments="s:Object[]" x:Key="Parameters">[New Object() { UpdateStep19_2, UpdateStep19_4 }]</InArgument>
                                                          <InArgument x:TypeArguments="s:Type" x:Key="TargetType">
                                                            <mxswa:ReferenceLiteral x:TypeArguments="s:Type" Value="x:Int32" />
                                                          </InArgument>
                                                          <OutArgument x:TypeArguments="x:Object" x:Key="Result">[UpdateStep19_1]</OutArgument>
                                                        </mxswa:ActivityReference.Arguments>
                                                      </mxswa:ActivityReference>
                                                      <mxswa:SetEntityProperty Attribute="chorus_numberofrequestsforconsentsent" Entity="[CreatedEntities(&quot;related_cdi_leadid#lead#Temp&quot;)]" EntityName="lead" Value="[UpdateStep19_1]">
                                                        <mxswa:SetEntityProperty.TargetType>
                                                          <InArgument x:TypeArguments="s:Type">
                                                            <mxswa:ReferenceLiteral x:TypeArguments="s:Type" Value="x:Int32" />
                                                          </InArgument>
                                                        </mxswa:SetEntityProperty.TargetType>
                                                      </mxswa:SetEntityProperty>
                                                      <mxswa:UpdateEntity DisplayName="UpdateStep19" Entity="[CreatedEntities(&quot;related_cdi_leadid#lead#Temp&quot;)]" EntityName="lead" />
                                                      <Assign x:TypeArguments="mxs:Entity" To="[InputEntities(&quot;related_cdi_leadid#lead&quot;)]" Value="[CreatedEntities(&quot;related_cdi_leadid#lead#Temp&quot;)]" />
                                                      <Persist />
                                                    </Sequence>
                                                    <mxswa:ActivityReference AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.ConditionSequence, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="ConditionStep20: Check if last Request was earlier than this one">
                                                      <mxswa:ActivityReference.Arguments>
                                                        <InArgument x:TypeArguments="x:Boolean" x:Key="Wait">False</InArgument>
                                                      </mxswa:ActivityReference.Arguments>
                                                      <mxswa:ActivityReference.Properties>
                                                        <sco:Collection x:TypeArguments="Variable" x:Key="Variables">
                                                          <Variable x:TypeArguments="x:Boolean" Default="False" Name="ConditionBranchStep21_condition" />
                                                          <Variable x:TypeArguments="x:Boolean" Default="False" Name="ConditionBranchStep21_1" />
                                                          <Variable x:TypeArguments="x:Object" Name="ConditionBranchStep21_2" />
                                                          <Variable x:TypeArguments="x:Object" Name="ConditionBranchStep21_3" />
                                                          <Variable x:TypeArguments="x:Boolean" Default="False" Name="ConditionBranchStep21_4" />
                                                          <Variable x:TypeArguments="x:Object" Name="ConditionBranchStep21_5" />
                                                        </sco:Collection>
                                                        <sco:Collection x:TypeArguments="Activity" x:Key="Activities">
                                                          <mxswa:GetEntityProperty Attribute="cdi_senton" Entity="[InputEntities(&quot;primaryEntity&quot;)]" EntityName="cdi_sentemail" Value="[ConditionBranchStep21_2]">
                                                            <mxswa:GetEntityProperty.TargetType>
                                                              <InArgument x:TypeArguments="s:Type">
                                                                <mxswa:ReferenceLiteral x:TypeArguments="s:Type">
                                                                  <x:Null />
                                                                </mxswa:ReferenceLiteral>
                                                              </InArgument>
                                                            </mxswa:GetEntityProperty.TargetType>
                                                          </mxswa:GetEntityProperty>
                                                          <mxswa:GetEntityProperty Attribute="chorus_lastrequestforconsentsenton" Entity="[InputEntities(&quot;related_cdi_leadid#lead&quot;)]" EntityName="lead" Value="[ConditionBranchStep21_3]">
                                                            <mxswa:GetEntityProperty.TargetType>
                                                              <InArgument x:TypeArguments="s:Type">
                                                                <mxswa:ReferenceLiteral x:TypeArguments="s:Type">
                                                                  <x:Null />
                                                                </mxswa:ReferenceLiteral>
                                                              </InArgument>
                                                            </mxswa:GetEntityProperty.TargetType>
                                                          </mxswa:GetEntityProperty>
                                                          <mxswa:ActivityReference AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.EvaluateCondition, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="EvaluateCondition">
                                                            <mxswa:ActivityReference.Arguments>
                                                              <InArgument x:TypeArguments="mxsq:ConditionOperator" x:Key="ConditionOperator">GreaterThan</InArgument>
                                                              <InArgument x:TypeArguments="s:Object[]" x:Key="Parameters">[New Object() { ConditionBranchStep21_3 }]</InArgument>
                                                              <InArgument x:TypeArguments="x:Object" x:Key="Operand">[ConditionBranchStep21_2]</InArgument>
                                                              <OutArgument x:TypeArguments="x:Boolean" x:Key="Result">[ConditionBranchStep21_1]</OutArgument>
                                                            </mxswa:ActivityReference.Arguments>
                                                          </mxswa:ActivityReference>
                                                          <mxswa:GetEntityProperty Attribute="chorus_lastrequestforconsentsenton" Entity="[InputEntities(&quot;related_cdi_leadid#lead&quot;)]" EntityName="lead" Value="[ConditionBranchStep21_5]">
                                                            <mxswa:GetEntityProperty.TargetType>
                                                              <InArgument x:TypeArguments="s:Type">
                                                                <mxswa:ReferenceLiteral x:TypeArguments="s:Type">
                                                                  <x:Null />
                                                                </mxswa:ReferenceLiteral>
                                                              </InArgument>
                                                            </mxswa:GetEntityProperty.TargetType>
                                                          </mxswa:GetEntityProperty>
                                                          <mxswa:ActivityReference AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.EvaluateCondition, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="EvaluateCondition">
                                                            <mxswa:ActivityReference.Arguments>
                                                              <InArgument x:TypeArguments="mxsq:ConditionOperator" x:Key="ConditionOperator">Null</InArgument>
                                                              <x:Null x:Key="Parameters" />
                                                              <InArgument x:TypeArguments="x:Object" x:Key="Operand">[ConditionBranchStep21_5]</InArgument>
                                                              <OutArgument x:TypeArguments="x:Boolean" x:Key="Result">[ConditionBranchStep21_4]</OutArgument>
                                                            </mxswa:ActivityReference.Arguments>
                                                          </mxswa:ActivityReference>
                                                          <mxswa:ActivityReference AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.EvaluateLogicalCondition, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="EvaluateLogicalCondition">
                                                            <mxswa:ActivityReference.Arguments>
                                                              <InArgument x:TypeArguments="mxsq:LogicalOperator" x:Key="LogicalOperator">Or</InArgument>
                                                              <InArgument x:TypeArguments="x:Boolean" x:Key="LeftOperand">[ConditionBranchStep21_1]</InArgument>
                                                              <InArgument x:TypeArguments="x:Boolean" x:Key="RightOperand">[ConditionBranchStep21_4]</InArgument>
                                                              <OutArgument x:TypeArguments="x:Boolean" x:Key="Result">[ConditionBranchStep21_condition]</OutArgument>
                                                            </mxswa:ActivityReference.Arguments>
                                                          </mxswa:ActivityReference>
                                                          <mxswa:ActivityReference AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.ConditionBranch, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="ConditionBranchStep21">
                                                            <mxswa:ActivityReference.Arguments>
                                                              <InArgument x:TypeArguments="x:Boolean" x:Key="Condition">[ConditionBranchStep21_condition]</InArgument>
                                                            </mxswa:ActivityReference.Arguments>
                                                            <mxswa:ActivityReference.Properties>
                                                              <mxswa:ActivityReference x:Key="Then" AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.Composite, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="ConditionBranchStep21">
                                                                <mxswa:ActivityReference.Properties>
                                                                  <sco:Collection x:TypeArguments="Variable" x:Key="Variables" />
                                                                  <sco:Collection x:TypeArguments="Activity" x:Key="Activities">
                                                                    <Sequence DisplayName="UpdateStep24">
                                                                      <Sequence.Variables>
                                                                        <Variable x:TypeArguments="x:Object" Name="UpdateStep24_1" />
                                                                        <Variable x:TypeArguments="x:Object" Name="UpdateStep24_2" />
                                                                      </Sequence.Variables>
                                                                      <Assign x:TypeArguments="mxs:Entity" To="[CreatedEntities(&quot;related_cdi_leadid#lead#Temp&quot;)]" Value="[New Entity(&quot;lead&quot;)]" />
                                                                      <Assign x:TypeArguments="s:Guid" To="[CreatedEntities(&quot;related_cdi_leadid#lead#Temp&quot;).Id]" Value="[InputEntities(&quot;related_cdi_leadid#lead&quot;).Id]" />
                                                                      <mxswa:GetEntityProperty Attribute="cdi_senton" Entity="[InputEntities(&quot;primaryEntity&quot;)]" EntityName="cdi_sentemail" Value="[UpdateStep24_2]">
                                                                        <mxswa:GetEntityProperty.TargetType>
                                                                          <InArgument x:TypeArguments="s:Type">
                                                                            <mxswa:ReferenceLiteral x:TypeArguments="s:Type" Value="s:DateTime" />
                                                                          </InArgument>
                                                                        </mxswa:GetEntityProperty.TargetType>
                                                                      </mxswa:GetEntityProperty>
                                                                      <mxswa:ActivityReference AssemblyQualifiedName="Microsoft.Crm.Workflow.Activities.EvaluateExpression, Microsoft.Crm.Workflow, Version=8.0.0.0, Culture=neutral, PublicKeyToken=31bf3856ad364e35" DisplayName="EvaluateExpression">
                                                                        <mxswa:ActivityReference.Arguments>
                                                                          <InArgument x:TypeArguments="x:String" x:Key="ExpressionOperator">SelectFirstNonNull</InArgument>
                                                                          <InArgument x:TypeArguments="s:Object[]" x:Key="Parameters">[New Object() { UpdateStep24_2 }]</InArgument>
                                                                          <InArgument x:TypeArguments="s:Type" x:Key="TargetType">
                                                                            <mxswa:ReferenceLiteral x:TypeArguments="s:Type" Value="s:DateTime" />
                                                                          </InArgument>
                                                                          <OutArgument x:TypeArguments="x:Object" x:Key="Result">[UpdateStep24_1]</OutArgument>
                                                                        </mxswa:ActivityReference.Arguments>
                                                                      </mxswa:ActivityReference>
                                                                      <mxswa:SetEntityProperty Attribute="chorus_lastrequestforconsentsenton" Entity="[CreatedEntities(&quot;related_cdi_leadid#lead#Temp&quot;)]" EntityName="lead" Value="[UpdateStep24_1]">
                                                                        <mxswa:SetEntityProperty.TargetType>
                                                                          <InArgument x:TypeArguments="s:Type">
                                                                            <mxswa:ReferenceLiteral x:TypeArguments="s:Type" Value="s:DateTime" />
                                                                          </InArgument>
                                                                        </mxswa:SetEntityProperty.TargetType>
                                                                      </mxswa:SetEntityProperty>
                                                                      <mxswa:UpdateEntity DisplayName="UpdateStep24" Entity="[CreatedEntities(&quot;related_cdi_leadid#lead#Temp&quot;)]" EntityName="lead" />
                                                                      <Assign x:TypeArguments="mxs:Entity" To="[InputEntities(&quot;related_cdi_leadid#lead&quot;)]" Value="[CreatedEntities(&quot;related_cdi_leadid#lead#Temp&quot;)]" />
                                                                      <Persist />
                                                                    </Sequence>
                                                                  </sco:Collection>
                                                                </mxswa:ActivityReference.Properties>
                                                              </mxswa:ActivityReference>
                                                              <x:Null x:Key="Else" />
                                                              <x:Null x:Key="Description" />
                                                            </mxswa:ActivityReference.Properties>
                                                          </mxswa:ActivityReference>
                                                        </sco:Collection>
                                                        <x:Boolean x:Key="ContainsElseBranch">False</x:Boolean>
                                                      </mxswa:ActivityReference.Properties>
                                                    </mxswa:ActivityReference>
                                                  </sco:Collection>
                                                </mxswa:ActivityReference.Properties>
                                              </mxswa:ActivityReference>
                                              <x:Null x:Key="Else" />
                                              <x:Null x:Key="Description" />
                                            </mxswa:ActivityReference.Properties>
                                          </mxswa:ActivityReference>
                                        </sco:Collection>
                                        <x:Boolean x:Key="ContainsElseBranch">False</x:Boolean>
                                      </mxswa:ActivityReference.Properties>
                                    </mxswa:ActivityReference>
                                  </sco:Collection>
                                </mxswa:ActivityReference.Properties>
                              </mxswa:ActivityReference>
                              <x:Null x:Key="Else" />
                              <x:Null x:Key="Description" />
                            </mxswa:ActivityReference.Properties>
                          </mxswa:ActivityReference>
                        </sco:Collection>
                        <x:Boolean x:Key="ContainsElseBranch">False</x:Boolean>
                      </mxswa:ActivityReference.Properties>
                    </mxswa:ActivityReference>
                  </sco:Collection>
                </mxswa:ActivityReference.Properties>
              </mxswa:ActivityReference>
              <x:Null x:Key="Else" />
              <x:Null x:Key="Description" />
            </mxswa:ActivityReference.Properties>
          </mxswa:ActivityReference>
        </sco:Collection>
        <x:Boolean x:Key="ContainsElseBranch">False</x:Boolean>
      </mxswa:ActivityReference.Properties>
    </mxswa:ActivityReference>
  </mxswa:Workflow>
</Activity>